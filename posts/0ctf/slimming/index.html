<!doctype html>
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="description" content="Personal blog">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="robots" content="all,index,follow">

  <title>0ctf 2015: slimming- br0ns</title>

  <link href="http://fonts.googleapis.com/css?family=Josefin+Sans" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Oswald" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Quicksand" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Crimson+Text" rel="stylesheet" type="text/css">
  <link href="http://fonts.googleapis.com/css?family=Inconsolata" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

  <link rel="stylesheet" href="../../../css/normalize.css">
  <link rel="stylesheet" href="../../../css/noise.css">
  <link rel="stylesheet" href="../../../css/style.css">

  <!-- This is needed because Chrome gets the x-height wrong for the "Crimson
    -- Text" font... no clue why
    -->
  <script type="text/javascript">
    window.MathJax = {
    "HTML-CSS": {minScaleAdjust: 100}
    };
  </script>

  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
  <script type="text/javascript" src="../../../js/highslide.js"></script>
  <script type="text/javascript" src="../../../js/script.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->

  

</head>

<body>
  <div id="header-container">
<header>
  <div id="header">
    <div id="title">
      <a href="../../../posts/0ctf/slimming">
        0ctf 2015: slimming
      </a>
    </div>

    
    <div id="byline">
      Points: 200, Category: reverse
    </div>
    

    
    <div id="meta">
      <ul>
        <li>
          
          <span title="Edited 2017-05-08 22:32:33">
            <i class="fa fa-calendar"></i>&nbsp;
            September 10, 2015
            

            
          </span>
          
        </li>

        <li>
          <i class="fa fa-code-fork"></i>&nbsp;
          <a href="https://github.com/br0ns/blog/commit/b334f8989e49127b1d2f687a8d41a67f02a670c9" title="View on GitHub">
            b334f89&hellip;
          </a>
        </li>

        
        <li>
          <i class="fa fa-tags"></i>&nbsp;
          <a href="../../../tags/writeups">Writeups</a>
        </li>
        

      </ul>
    </div>
    

  </div>

  <div id="navbar-placeholder">

    <div id="navbar">
      <nav id="main-nav">
        <ul>
          <li>
            <a href="../../../">
              <i class="fa fa-lg fa-home"></i>
            </a>
          </li>

          <li>
            <a href="https://github.com/br0ns">
              <i class="fa fa-lg fa-github"></i>
            </a>
          </li>

          <li>
            <a href="../../../about">About</a>
          </li>

          <li>
            <a href="../../../tags/all">Archive</a>
          </li>

          <li>
            <a id="search-link">Search</a>
          </li>

        </ul>
      </nav>

      <div id="search-form-container">
        <form class="search" action="http://google.com/search" method="get">
          <input id="input" type="text" results="0" placeholder autocomplete="off" spellcheck="false">
        <input id="query" type="hidden" name="q" value>
        </form>
      </div>

    </div>

  </div>

</header>

  </div>

  <article id="content">
    <blockquote>
<p>Foodie has eaten so much delicious food and decide to slim now &gt;_&lt;.</p>
<p><a href="../../../posts/0ctf/slimming/slimming.tar.gz">slimming</a></p>
</blockquote>
<p><strong>TL;DR</strong>: <a href="../../../posts/0ctf/slimming/doit.py" class="uri">doit.py</a></p>
<p>The <a href="../../../posts/0ctf/slimming/slimming.tar.gz">TAR archive</a> contains two files; <code>slimming</code> which is an AMD64 ELF binary, and <code>slimming_data</code> which is more or less (but mostly less) random looking binary data.</p>
<p>Running the binary with no arguments prints a usage message:</p>
<div class="codeblock-container"><figure class="codeblock"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet0" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span>$ ./slimming
</span><span id="line-2"><span class="lineno">2 </span>Usage: slimming &lt;input&gt; &lt;output&gt;
</span></pre></div>
</figure></div>
<p>And with arguments it converts a file to that random-y looking format:</p>
<div class="codeblock-container"><figure class="codeblock"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet1" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span>$ echo foobar &gt; /tmp/foo
</span><span id="line-2"><span class="lineno">2 </span>$ ./slimming /tmp/foo /tmp/bar
</span><span id="line-3"><span class="lineno">3 </span>Done!
</span><span id="line-4"><span class="lineno">4 </span>$ phd /tmp/bar
</span><span id="line-5"><span class="lineno">5 </span>00000000  30 6f 70 73  a9 43 c4 46  f3 30 d0 50  cc 33 fe 35  │0ops│·C·F│·0·P│·3·5│
</span><span id="line-6"><span class="lineno">6 </span>00000010  c1 31                                               │·1│
</span><span id="line-7"><span class="lineno">7 </span>00000012
</span></pre></div>
</figure></div>
<p>After firing up IDA and looking at the binary for about five seconds I decide no, I’m going to blackbox this thing (It’s full of MMX ugliness).</p>
<p>So first off I create a python function to run a string through the program.</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet2.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="kn">from</span> <span class="nn">pwn</span> <span class="kn">import</span> <span class="o">*</span>
</span><span id="line-2"><span class="lineno">2 </span>
</span><span id="line-3"><span class="lineno">3 </span><span class="k">def</span> <span class="nf">blackbox</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="line-4"><span class="lineno">4 </span>    <span class="n">write</span><span class="p">(</span><span class="s1">'/tmp/foo'</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
</span><span id="line-5"><span class="lineno">5 </span>    <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">'./slimming /tmp/foo /tmp/bar &gt;/dev/null'</span><span class="p">)</span>
</span><span id="line-6"><span class="lineno">6 </span>    <span class="k">return</span> <span class="n">read</span><span class="p">(</span><span class="s1">'/tmp/bar'</span><span class="p">)</span>
</span></pre></div>
</figure></div>
<p>Tradition dictates that I must now trow A’s at it:</p>
<div class="codeblock-container"><figure class="codeblock"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet3" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span>for n in range(1, 10):
</span><span id="line-2"><span class="lineno">2 </span>    s = 'A' * n
</span><span id="line-3"><span class="lineno">3 </span>    t = blackbox(s)
</span><span id="line-4"><span class="lineno">4 </span>    print s
</span><span id="line-5"><span class="lineno">5 </span>    print hexdump(t)
</span></pre></div>
</figure></div>
<p>Output (formatted slightly):</p>
<div class="codeblock-container"><figure class="codeblock"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet4" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno"> 1 </span>&quot;A&quot; -&gt;
</span><span id="line-2"><span class="lineno"> 2 </span>00000000  30 6f 70 73  8e 43                                  │0ops│·C│
</span><span id="line-3"><span class="lineno"> 3 </span>&quot;AA&quot; -&gt;
</span><span id="line-4"><span class="lineno"> 4 </span>00000000  30 6f 70 73  8e 43 ea 46                            │0ops│·C·F││
</span><span id="line-5"><span class="lineno"> 5 </span>&quot;AAA&quot; -&gt;
</span><span id="line-6"><span class="lineno"> 6 </span>00000000  30 6f 70 73  8e 43 54 47                            │0ops│·CTG││
</span><span id="line-7"><span class="lineno"> 7 </span>&quot;AAAA&quot; -&gt;
</span><span id="line-8"><span class="lineno"> 8 </span>00000000  30 6f 70 73  8e 43 54 47  dd 30                     │0ops│·CTG│·0│
</span><span id="line-9"><span class="lineno"> 9 </span>&quot;AAAAA&quot; -&gt;
</span><span id="line-10"><span class="lineno">10 </span>00000000  30 6f 70 73  8e 43 54 47  63 31                     │0ops│·CTG│c1│
</span><span id="line-11"><span class="lineno">11 </span>&quot;AAAAAA&quot; -&gt;
</span><span id="line-12"><span class="lineno">12 </span>00000000  30 6f 70 73  8e 43 54 47  62 31                     │0ops│·CTG│b1│
</span><span id="line-13"><span class="lineno">13 </span>&quot;AAAAAAA&quot; -&gt;
</span><span id="line-14"><span class="lineno">14 </span>00000000  30 6f 70 73  8e 43 54 47  62 31 f3 50               │0ops│·CTG│b1·P││
</span><span id="line-15"><span class="lineno">15 </span>&quot;AAAAAAAA&quot; -&gt;
</span><span id="line-16"><span class="lineno">16 </span>00000000  30 6f 70 73  8e 43 54 47  62 31 4d 51               │0ops│·CTG│b1MQ││
</span><span id="line-17"><span class="lineno">17 </span>&quot;AAAAAAAAA&quot; -&gt;
</span><span id="line-18"><span class="lineno">18 </span>00000000  30 6f 70 73  8e 43 54 47  62 31 4c 51               │0ops│·CTG│b1LQ││
</span></pre></div>
</figure></div>
<p>There are few interesting points to notice already:</p>
<ul>
<li><p>The output always starts with “0ops”.</p></li>
<li><p>Bytes 5 and 6 are <code>8e 43</code> in all my tests.</p></li>
<li><p>The output grows by increments of two. This suggests that the output bytes should be interpreted as pairs.</p></li>
<li><p>The output grows slower as more A’s are added. This suggest we’re dealing with a compression program (which also fits well withe the name of the challenge).</p></li>
<li><p>The output seems to be obfuscated on a per-byte basis, and the obfuscation is static. If not, the output would have changed for the different inputs.</p></li>
<li><p>A given pair will change as the input grows. After a certain number of changes the pair stays the same. The second byte in the pair only changes the first time, and only its LSB is changed. The first byte changes much the first time, and then only a little on subsequent inputs.</p></li>
</ul>
<p>The last two points and a little bit of guessing is enough to de-obfuscate the output; First I guess that the output is xor’ed with a static stream before being written to the output file. Why xor? It always is.</p>
<p>So to recover the stream a known output is needed. Why is it that the first byte change by a lot and the second only by one bit? Since the program is doing compression it is natural to believe that it maintains some kind of dictionary of things that it has already seen; when it sees something it knows it just outputs a reference.</p>
<p>This model fits well with our data: The second byte changes from “literal” to “reference” and the first byte changes from the literal “A” to a reference. Also notice that references always encode strings longer that a single character (or else the last A would not be encoded as a literal).</p>
<p>Lastly the first pair will always be a literal since there will not yet be anything to reference.</p>
<p>I guess that “literal” is encoded as <code>0</code> — the actual value used internally in the program doesn’t matter.</p>
<p>The input strings that are of interest to me are those that first produce a new pair, that is “A”, “AA”, “AAAA”, “AAAAAAA”, …</p>
<p>Given the model I have guessed at, these strings must be encoded as:</p>
<ul>
<li><p>“A”: <code>[Lit &quot;A&quot;]</code></p></li>
<li><p>“AA”: <code>[Lit &quot;A&quot;​, Lit &quot;A&quot;]</code></p></li>
<li><p>“AAAA”: <code>[Lit &quot;A&quot;​, Ref &quot;AA&quot;​, Lit &quot;A&quot;]</code></p></li>
<li><p>“AAAAAAA”: <code>[Lit &quot;A&quot;​, Ref &quot;AA&quot;​, Ref &quot;AAA&quot;​, Lit &quot;A&quot;]</code></p></li>
</ul>
<p>There’s a pattern here: For <em>n</em> pairs the number of A’s encoded by the first <em>n - 1</em> pairs is <em>1 + … + n - 1 = T<sub>n-1</sub></em> and the last pair then encodes a literal A.</p>
<p>Now we can recover the first, say 100, bytes of the xor stream:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet5.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="n">stream</span> <span class="o">=</span> <span class="s1">''</span>
</span><span id="line-2"><span class="lineno">2 </span><span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">51</span><span class="p">):</span>
</span><span id="line-3"><span class="lineno">3 </span>    <span class="c1"># T_(n-1) in closed form</span>
</span><span id="line-4"><span class="lineno">4 </span>    <span class="n">m</span> <span class="o">=</span> <span class="p">(</span><span class="n">n</span> <span class="o">*</span> <span class="p">(</span><span class="n">n</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="line-5"><span class="lineno">5 </span>    <span class="n">t</span> <span class="o">=</span> <span class="n">blackbox</span><span class="p">(</span><span class="s1">'A'</span> <span class="o">*</span> <span class="n">m</span><span class="p">)</span>
</span><span id="line-6"><span class="lineno">6 </span>    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="o">==</span> <span class="mi">4</span> <span class="o">+</span> <span class="n">n</span> <span class="o">*</span> <span class="mi">2</span>
</span><span id="line-7"><span class="lineno">7 </span>    <span class="n">stream</span> <span class="o">+=</span> <span class="n">xor</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:],</span> <span class="p">(</span><span class="s1">'A'</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</span><span id="line-8"><span class="lineno">8 </span><span class="k">print</span> <span class="n">hexdump</span><span class="p">(</span><span class="n">stream</span><span class="p">)</span>
</span></pre></div>
</figure></div>
<p>This is the result:</p>
<div class="codeblock-container"><figure class="codeblock"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet6" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span>00000000  cf 43 ab 46  9c 30 b2 50  ad 33 8c 35  cb 31 98 4f  │·C·F│·0·P│·3·5│·1·O│
</span><span id="line-2"><span class="lineno">2 </span>00000010  8d 31 8b 48  92 6d cc 4d  ba 64 cb 00  cf 43 ab 46  │·1·H│·m·M│·d··│·C·F│
</span><span id="line-3"><span class="lineno">3 </span>00000020  9c 30 b2 50  ad 33 8c 35  cb 31 98 4f  8d 31 8b 48  │·0·P│·3·5│·1·O│·1·H│
</span><span id="line-4"><span class="lineno">4 </span>00000030  92 6d cc 4d  ba 64 cb 00  cf 43 ab 46  9c 30 b2 50  │·m·M│·d··│·C·F│·0·P│
</span><span id="line-5"><span class="lineno">5 </span>00000040  ad 33 8c 35  cb 31 98 4f  8d 31 8b 48  92 6d cc 4d  │·3·5│·1·O│·1·H│·m·M│
</span><span id="line-6"><span class="lineno">6 </span>00000050  ba 64 cb 00  cf 43 ab 46  9c 30 b2 50  ad 33 8c 35  │·d··│·C·F│·0·P│·3·5│
</span><span id="line-7"><span class="lineno">7 </span>00000060  cb 31 98 4f                                         │·1·O││
</span><span id="line-8"><span class="lineno">8 </span>00000064
</span></pre></div>
</figure></div>
<p>Looks like the stream is cyclic with a period of 28. I now define a more usable blackbox without the obfuscation:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet7.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="k">def</span> <span class="nf">blackbox_inner</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="line-2"><span class="lineno">2 </span>    <span class="n">stream</span> <span class="o">=</span> <span class="p">[</span><span class="mi">207</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span>
</span><span id="line-3"><span class="lineno">3 </span>              <span class="mi">152</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="line-4"><span class="lineno">4 </span>    <span class="n">t</span> <span class="o">=</span> <span class="n">blackbox</span><span class="p">(</span><span class="n">s</span><span class="p">)[</span><span class="mi">4</span><span class="p">:]</span>
</span><span id="line-5"><span class="lineno">5 </span>    <span class="k">return</span> <span class="n">ordlist</span><span class="p">(</span><span class="n">xor</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">stream</span><span class="p">,</span> <span class="n">cut</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">))</span>
</span></pre></div>
</figure></div>
<p>Running <code>blackbox_inner('A' * 20)</code> yields:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet8.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span></pre></div>
</figure></div>
<p>Looks like the references are encoded as negative indexes into a dictionary of tokens.</p>
<p>Encoding “AAAAAAAAA” (nine A’s) must go something like this:</p>
<ul>
<li>1<sup>st</sup> pair:
<ul>
<li>Is “AA” in the dictionary? No.</li>
<li>Output literal “A”: <code>('A'​, 0)</code></li>
</ul></li>
<li>2<sup>nd</sup> pair:
<ul>
<li>Is “AA” in the dictionary? Yes.</li>
<li>Is “AAA” in the dictionary? No.</li>
<li>Output reference to “AA”: <code>(-1​, 0)</code></li>
</ul></li>
<li>3<sup>rd</sup> pair:
<ul>
<li>Is “AA” in the dictionary? Yes.</li>
<li>Is “AAA” in the dictionary? Yes.</li>
<li>Is “AAAA” in the dictionary? No.</li>
<li>Output reference to “AAA”: <code>(-2​, 0)</code></li>
</ul></li>
<li>4<sup>th</sup> pair:
<ul>
<li>Is “AA” in the dictionary? Yes.</li>
<li>Is “AAA” in the dictionary? Yes.</li>
<li>Is “AAAA” in the dictionary? No.</li>
<li>Output reference to “AAA”: <code>(-2​, 0)</code></li>
</ul></li>
</ul>
<p>Of course the question now is “how is the table being build”. The token “AA” must have been added to the dictionary between outputting the 1<sup>st</sup> and 2<sup>nd</sup> pair.</p>
<p>Hypothesis: Each time a token is outputted a token consisting of itself and the letter just before it is added to the dictionary.</p>
<p>This model fits with the data, so I perform a few more tests to confirm or discard the hypothesis:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet9.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="n">blackbox_inner</span><span class="p">(</span><span class="s1">'ABAB'</span><span class="p">)</span>
</span><span id="line-2"><span class="lineno">2 </span>  <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span><span id="line-3"><span class="lineno">3 </span><span class="n">blackbox_inner</span><span class="p">(</span><span class="s1">'ABABBAB'</span><span class="p">)</span>
</span><span id="line-4"><span class="lineno">4 </span>  <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span></pre></div>
</figure></div>
<p>Oops, hypothesis discarded ☹. (The second “AB” would have added “BAB” to the dictionary, which was clearly not the case.)</p>
<p>Revised hypothesis: Each time a token is outputted a token consisting of the previous token and the first letter of the token being outputted is added to the dictionary.</p>
<p>Note that this model fits both the A-tests and the two tests above.</p>
<p>Testing:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet10.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="n">blackbox_inner</span><span class="p">(</span><span class="s1">'ABABXABX'</span><span class="p">)</span>
</span><span id="line-2"><span class="lineno">2 </span>  <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span></pre></div>
</figure></div>
<p>Yep, “ABX” (<em>=</em> “AB” + “X”) was in the dictionary.</p>
<p>Why is the reference 253? Because “BA” was added between the 2<sup>nd</sup> and 3<sup>rd</sup> pair:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet11.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="n">blackbox_inner</span><span class="p">(</span><span class="s1">'ABABXABXBA'</span><span class="p">)</span>
</span><span id="line-2"><span class="lineno">2 </span>  <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">254</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span></pre></div>
</figure></div>
<p>Two questions remain:</p>
<ol type="1">
<li>What happens if the dictionary grows beyond 255 entries?</li>
<li>Is the <em>n</em><sup>th</sup> entry added to the dictionary before or after the <em>n</em><sup>th</sup> pair is generated? That is, can a token reference itself?</li>
</ol>
<p>The first one is easy to test:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet12.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="n">s</span> <span class="o">=</span> <span class="s1">''</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">chr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">256</span><span class="p">))</span> <span class="o">+</span> <span class="s1">'AAA'</span>
</span><span id="line-2"><span class="lineno">2 </span><span class="n">blackbox_inner</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span><span id="line-3"><span class="lineno">3 </span>  <span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
</span></pre></div>
</figure></div>
<p>Aha, so the second component in the pairs is part of the dictionary index.</p>
<p>For the second question I design this test:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet13.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="n">blackbox_inner</span><span class="p">(</span><span class="s1">'ABABABA'</span><span class="p">)</span>
</span><span id="line-2"><span class="lineno">2 </span>  <span class="p">[</span><span class="mi">65</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">253</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</span></pre></div>
</figure></div>
<p>The last token added to the dictionary is “ABA” which is referenced in the last pair. This might seem a little odd; how would you know what the token is when you decompress? Actually it’s not a problem: when decompressing a pair which reference a token which was not yet added to the dictionary then the referenced token must be the one which are about to be added. That token is the previous outputted token plus the first letter of the current — but the first letter must then also be the first letter of the previous token!</p>
<p>In the example above, the last token references itself: the previous token was “AB”, so the last one must be “AB” + “AB”[0] = “ABA”.</p>
<p>I can now build a compression function:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet14.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno"> 1 </span><span class="k">def</span> <span class="nf">compress_inner</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="line-2"><span class="lineno"> 2 </span>    <span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-3"><span class="lineno"> 3 </span>    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="line-4"><span class="lineno"> 4 </span>    <span class="n">prev</span> <span class="o">=</span> <span class="bp">None</span>
</span><span id="line-5"><span class="lineno"> 5 </span>    <span class="n">out</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-6"><span class="lineno"> 6 </span>    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="line-7"><span class="lineno"> 7 </span>        <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
</span><span id="line-8"><span class="lineno"> 8 </span>            <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev</span> <span class="o">+</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</span><span id="line-9"><span class="lineno"> 9 </span>        <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="line-10"><span class="lineno">10 </span>        <span class="k">while</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="ow">and</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="ow">in</span> <span class="n">d</span><span class="p">:</span>
</span><span id="line-11"><span class="lineno">11 </span>            <span class="n">j</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="line-12"><span class="lineno">12 </span>        <span class="n">token</span> <span class="o">=</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">:</span><span class="n">j</span><span class="p">]</span>
</span><span id="line-13"><span class="lineno">13 </span>        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
</span><span id="line-14"><span class="lineno">14 </span>            <span class="n">idx</span> <span class="o">=</span> <span class="n">d</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
</span><span id="line-15"><span class="lineno">15 </span>            <span class="n">idxa</span> <span class="o">=</span> <span class="p">(</span><span class="mi">255</span> <span class="o">-</span> <span class="n">idx</span> <span class="o">&amp;</span> <span class="mh">0xff</span><span class="p">)</span>
</span><span id="line-16"><span class="lineno">16 </span>            <span class="n">idxb</span> <span class="o">=</span> <span class="p">(</span><span class="n">idx</span> <span class="o">&gt;&gt;</span> <span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
</span><span id="line-17"><span class="lineno">17 </span>            <span class="n">out</span> <span class="o">+=</span> <span class="p">[</span><span class="n">idxa</span><span class="p">,</span> <span class="n">idxb</span><span class="p">]</span>
</span><span id="line-18"><span class="lineno">18 </span>        <span class="k">else</span><span class="p">:</span>
</span><span id="line-19"><span class="lineno">19 </span>            <span class="n">out</span> <span class="o">+=</span> <span class="p">[</span><span class="nb">ord</span><span class="p">(</span><span class="n">token</span><span class="p">),</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="line-20"><span class="lineno">20 </span>        <span class="n">prev</span> <span class="o">=</span> <span class="n">token</span>
</span><span id="line-21"><span class="lineno">21 </span>        <span class="n">i</span> <span class="o">=</span> <span class="n">j</span>
</span><span id="line-22"><span class="lineno">22 </span>    <span class="k">return</span> <span class="n">out</span>
</span><span id="line-23"><span class="lineno">23 </span>
</span><span id="line-24"><span class="lineno">24 </span><span class="k">def</span> <span class="nf">compress</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="line-25"><span class="lineno">25 </span>    <span class="n">stream</span> <span class="o">=</span> <span class="p">[</span><span class="mi">207</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span>
</span><span id="line-26"><span class="lineno">26 </span>              <span class="mi">152</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="line-27"><span class="lineno">27 </span>    <span class="k">return</span> <span class="s1">'0ops'</span> <span class="o">+</span> <span class="n">xor</span><span class="p">(</span><span class="n">compress_inner</span><span class="p">(</span><span class="n">s</span><span class="p">),</span> <span class="n">stream</span><span class="p">,</span> <span class="n">cut</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">)</span>
</span></pre></div>
</figure></div>
<p>And test it for correctness:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet15.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="line-2"><span class="lineno">2 </span>    <span class="n">s</span> <span class="o">=</span> <span class="n">randoms</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="line-3"><span class="lineno">3 </span>    <span class="k">assert</span> <span class="n">blackbox</span><span class="p">(</span><span class="n">s</span><span class="p">)</span> <span class="o">==</span> <span class="n">compress</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</span></pre></div>
</figure></div>
<p>And then, finally, a decompression function:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet16.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno"> 1 </span><span class="k">def</span> <span class="nf">decompress_inner</span><span class="p">(</span><span class="n">xs</span><span class="p">):</span>
</span><span id="line-2"><span class="lineno"> 2 </span>    <span class="n">d</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="line-3"><span class="lineno"> 3 </span>    <span class="n">prev</span> <span class="o">=</span> <span class="bp">None</span>
</span><span id="line-4"><span class="lineno"> 4 </span>    <span class="n">out</span> <span class="o">=</span> <span class="s1">''</span>
</span><span id="line-5"><span class="lineno"> 5 </span>    <span class="k">for</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="ow">in</span> <span class="n">group</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">xs</span><span class="p">):</span>
</span><span id="line-6"><span class="lineno"> 6 </span>        <span class="k">print</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span>
</span><span id="line-7"><span class="lineno"> 7 </span>        <span class="k">print</span> <span class="n">d</span>
</span><span id="line-8"><span class="lineno"> 8 </span>        <span class="k">if</span> <span class="n">b</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="line-9"><span class="lineno"> 9 </span>            <span class="n">token</span> <span class="o">=</span> <span class="nb">chr</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
</span><span id="line-10"><span class="lineno">10 </span>        <span class="k">else</span><span class="p">:</span>
</span><span id="line-11"><span class="lineno">11 </span>            <span class="n">idxa</span> <span class="o">=</span> <span class="n">a</span>
</span><span id="line-12"><span class="lineno">12 </span>            <span class="n">idxb</span> <span class="o">=</span> <span class="n">b</span>
</span><span id="line-13"><span class="lineno">13 </span>            <span class="n">idx</span> <span class="o">=</span> <span class="p">(</span><span class="n">idxb</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="mi">8</span> <span class="o">|</span> <span class="p">(</span><span class="mi">255</span> <span class="o">-</span> <span class="n">idxa</span><span class="p">)</span>
</span><span id="line-14"><span class="lineno">14 </span>            <span class="k">if</span> <span class="n">idx</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">d</span><span class="p">):</span>
</span><span id="line-15"><span class="lineno">15 </span>                <span class="n">token</span> <span class="o">=</span> <span class="n">prev</span> <span class="o">+</span> <span class="n">prev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="line-16"><span class="lineno">16 </span>            <span class="k">else</span><span class="p">:</span>
</span><span id="line-17"><span class="lineno">17 </span>                <span class="n">token</span> <span class="o">=</span> <span class="n">d</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
</span><span id="line-18"><span class="lineno">18 </span>        <span class="k">if</span> <span class="n">prev</span><span class="p">:</span>
</span><span id="line-19"><span class="lineno">19 </span>            <span class="n">d</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">prev</span> <span class="o">+</span> <span class="n">token</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="line-20"><span class="lineno">20 </span>        <span class="n">prev</span> <span class="o">=</span> <span class="n">token</span>
</span><span id="line-21"><span class="lineno">21 </span>        <span class="n">out</span> <span class="o">+=</span> <span class="n">token</span>
</span><span id="line-22"><span class="lineno">22 </span>    <span class="k">return</span> <span class="n">out</span>
</span><span id="line-23"><span class="lineno">23 </span>
</span><span id="line-24"><span class="lineno">24 </span><span class="k">def</span> <span class="nf">decompress</span><span class="p">(</span><span class="n">s</span><span class="p">):</span>
</span><span id="line-25"><span class="lineno">25 </span>    <span class="n">stream</span> <span class="o">=</span> <span class="p">[</span><span class="mi">207</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">171</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">156</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span> <span class="mi">178</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">173</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">140</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span>
</span><span id="line-26"><span class="lineno">26 </span>              <span class="mi">152</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">141</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">139</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">146</span><span class="p">,</span> <span class="mi">109</span><span class="p">,</span> <span class="mi">204</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">186</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">203</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="line-27"><span class="lineno">27 </span>    <span class="k">return</span> <span class="n">decompress_inner</span><span class="p">(</span><span class="n">ordlist</span><span class="p">(</span><span class="n">xor</span><span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">4</span><span class="p">:],</span> <span class="n">stream</span><span class="p">,</span> <span class="n">cut</span> <span class="o">=</span> <span class="s1">'left'</span><span class="p">)))</span>
</span></pre></div>
</figure></div>
<p>Of course I test it too:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet17.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000</span><span class="p">):</span>
</span><span id="line-2"><span class="lineno">2 </span>    <span class="n">s</span> <span class="o">=</span> <span class="n">randoms</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
</span><span id="line-3"><span class="lineno">3 </span>    <span class="k">assert</span> <span class="n">decompress</span><span class="p">(</span><span class="n">compress</span><span class="p">(</span><span class="n">s</span><span class="p">))</span> <span class="o">==</span> <span class="n">s</span>
</span></pre></div>
</figure></div>
<p>And the final step:</p>
<div class="codeblock-container"><figure class="codeblock python"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet18.py" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno">1 </span><span class="n">write</span><span class="p">(</span><span class="s1">'slimming_inner'</span><span class="p">,</span> <span class="n">decompress</span><span class="p">(</span><span class="n">read</span><span class="p">(</span><span class="s1">'slimming_data'</span><span class="p">)))</span>
</span></pre></div>
</figure></div>
<p>The result, <a href="../../../posts/0ctf/slimming/slimming_inner" class="uri">slimming_inner</a>, is an extremely small 32bit ELF. It is the simplest crackme you have ever seen:</p>
<div class="codeblock-container"><figure class="codeblock"><div class="buttons-container"><a href="../../../posts/0ctf/slimming/snippet19" class="download-link" title="Download snippet"><i class="fa fa-download"></i></a></div><div class="highlight"><pre><span></span><span id="line-1"><span class="lineno"> 1 </span>$ objdump -dMintel slimming_inner
</span><span id="line-2"><span class="lineno"> 2 </span>slimming_inner:     file format elf32-i386
</span><span id="line-3"><span class="lineno"> 3 </span>
</span><span id="line-4"><span class="lineno"> 4 </span>
</span><span id="line-5"><span class="lineno"> 5 </span>Disassembly of section .text:
</span><span id="line-6"><span class="lineno"> 6 </span>
</span><span id="line-7"><span class="lineno"> 7 </span>08048054 &lt;.text&gt;:
</span><span id="line-8"><span class="lineno"> 8 </span> 8048054:	83 ec 40             	sub    esp,0x40
</span><span id="line-9"><span class="lineno"> 9 </span> 8048057:	ba 40 00 00 00       	mov    edx,0x40
</span><span id="line-10"><span class="lineno">10 </span> 804805c:	89 e1                	mov    ecx,esp
</span><span id="line-11"><span class="lineno">11 </span> 804805e:	bb 00 00 00 00       	mov    ebx,0x0
</span><span id="line-12"><span class="lineno">12 </span> 8048063:	b8 03 00 00 00       	mov    eax,0x3
</span><span id="line-13"><span class="lineno">13 </span> 8048068:	cd 80                	int    0x80
</span><span id="line-14"><span class="lineno">14 </span> 804806a:	eb 17                	jmp    0x8048083
</span><span id="line-15"><span class="lineno">15 </span> 804806c:	89 c2                	mov    edx,eax
</span><span id="line-16"><span class="lineno">16 </span> 804806e:	89 e1                	mov    ecx,esp
</span><span id="line-17"><span class="lineno">17 </span> 8048070:	bb 01 00 00 00       	mov    ebx,0x1
</span><span id="line-18"><span class="lineno">18 </span> 8048075:	b8 04 00 00 00       	mov    eax,0x4
</span><span id="line-19"><span class="lineno">19 </span> 804807a:	cd 80                	int    0x80
</span><span id="line-20"><span class="lineno">20 </span> 804807c:	b8 01 00 00 00       	mov    eax,0x1
</span><span id="line-21"><span class="lineno">21 </span> 8048081:	cd 80                	int    0x80
</span><span id="line-22"><span class="lineno">22 </span> 8048083:	31 c0                	xor    eax,eax
</span><span id="line-23"><span class="lineno">23 </span> 8048085:	8a 04 24             	mov    al,BYTE PTR [esp]
</span><span id="line-24"><span class="lineno">24 </span> 8048088:	83 e8 30             	sub    eax,0x30
</span><span id="line-25"><span class="lineno">25 </span> 804808b:	0f 85 b0 02 00 00    	jne    0x8048341
</span><span id="line-26"><span class="lineno">26 </span> 8048091:	31 c0                	xor    eax,eax
</span><span id="line-27"><span class="lineno">27 </span> 8048093:	8a 44 24 01          	mov    al,BYTE PTR [esp+0x1]
</span><span id="line-28"><span class="lineno">28 </span> 8048097:	83 e8 63             	sub    eax,0x63
</span><span id="line-29"><span class="lineno">29 </span> 804809a:	0f 85 a1 02 00 00    	jne    0x8048341
</span><span id="line-30"><span class="lineno">30 </span> ...
</span><span id="line-31"><span class="lineno">31 </span> 8048309:	eb 00                	jmp    0x804830b
</span><span id="line-32"><span class="lineno">32 </span> 804830b:	c6 04 24 43          	mov    BYTE PTR [esp],0x43
</span><span id="line-33"><span class="lineno">33 </span> 804830f:	c6 44 24 01 6f       	mov    BYTE PTR [esp+0x1],0x6f
</span><span id="line-34"><span class="lineno">34 </span> 8048314:	c6 44 24 02 72       	mov    BYTE PTR [esp+0x2],0x72
</span><span id="line-35"><span class="lineno">35 </span> 8048319:	c6 44 24 03 72       	mov    BYTE PTR [esp+0x3],0x72
</span><span id="line-36"><span class="lineno">36 </span> 804831e:	c6 44 24 04 65       	mov    BYTE PTR [esp+0x4],0x65
</span><span id="line-37"><span class="lineno">37 </span> 8048323:	c6 44 24 05 63       	mov    BYTE PTR [esp+0x5],0x63
</span><span id="line-38"><span class="lineno">38 </span> 8048328:	c6 44 24 06 74       	mov    BYTE PTR [esp+0x6],0x74
</span><span id="line-39"><span class="lineno">39 </span> 804832d:	c6 44 24 07 0a       	mov    BYTE PTR [esp+0x7],0xa
</span><span id="line-40"><span class="lineno">40 </span> 8048332:	c6 44 24 08 00       	mov    BYTE PTR [esp+0x8],0x0
</span><span id="line-41"><span class="lineno">41 </span> 8048337:	b8 08 00 00 00       	mov    eax,0x8
</span><span id="line-42"><span class="lineno">42 </span> 804833c:	e9 2b fd ff ff       	jmp    0x804806c
</span><span id="line-43"><span class="lineno">43 </span> 8048341:	c6 04 24 4e          	mov    BYTE PTR [esp],0x4e
</span><span id="line-44"><span class="lineno">44 </span> 8048345:	c6 44 24 01 6f       	mov    BYTE PTR [esp+0x1],0x6f
</span><span id="line-45"><span class="lineno">45 </span> 804834a:	c6 44 24 02 2e       	mov    BYTE PTR [esp+0x2],0x2e
</span><span id="line-46"><span class="lineno">46 </span> 804834f:	c6 44 24 03 4e       	mov    BYTE PTR [esp+0x3],0x4e
</span><span id="line-47"><span class="lineno">47 </span> 8048354:	c6 44 24 04 6f       	mov    BYTE PTR [esp+0x4],0x6f
</span><span id="line-48"><span class="lineno">48 </span> 8048359:	c6 44 24 05 2e       	mov    BYTE PTR [esp+0x5],0x2e
</span><span id="line-49"><span class="lineno">49 </span> 804835e:	c6 44 24 06 2e       	mov    BYTE PTR [esp+0x6],0x2e
</span><span id="line-50"><span class="lineno">50 </span> 8048363:	c6 44 24 07 4e       	mov    BYTE PTR [esp+0x7],0x4e
</span><span id="line-51"><span class="lineno">51 </span> 8048368:	c6 44 24 08 6f       	mov    BYTE PTR [esp+0x8],0x6f
</span><span id="line-52"><span class="lineno">52 </span> 804836d:	c6 44 24 09 2e       	mov    BYTE PTR [esp+0x9],0x2e
</span><span id="line-53"><span class="lineno">53 </span> 8048372:	c6 44 24 0a 2e       	mov    BYTE PTR [esp+0xa],0x2e
</span><span id="line-54"><span class="lineno">54 </span> 8048377:	c6 44 24 0b 2e       	mov    BYTE PTR [esp+0xb],0x2e
</span><span id="line-55"><span class="lineno">55 </span> 804837c:	c6 44 24 0c 0a       	mov    BYTE PTR [esp+0xc],0xa
</span><span id="line-56"><span class="lineno">56 </span> 8048381:	c6 44 24 0d 00       	mov    BYTE PTR [esp+0xd],0x0
</span><span id="line-57"><span class="lineno">57 </span> 8048386:	b8 0d 00 00 00       	mov    eax,0xd
</span><span id="line-58"><span class="lineno">58 </span> 804838b:	e9 dc fc ff ff       	jmp    0x804806c
</span></pre></div>
</figure></div>
<p>The flag is: <strong><code>0ctf{AdD_15t_cHar_t0_7h3_eNd_wHEh_3xCept10n}</code></strong></p>

<br />

<center>
  (<a id="link-to-top" href="../../../posts/0ctf/slimming">To top</a>)
</center>

<br />

<h1 class="notoc">
  <span class="left-of">
    <span class="link-icon">
      <i class="fa fa-link"></i>
    </span>
    <span class="section-number">
    </span>
  </span>
  <span class="anchor" id="comments">
  </span>
  <a href="../../../posts/0ctf/slimming/#comments">
    Comments
  </a>
</h1>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES * * */
    var disqus_shortname = 'br0ns';

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>

  </article>

  <!-- Google analytics -->
  <script type="text/javascript">
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-67455623-1', 'auto');
    ga('send', 'pageview');
  </script>

</body>

</html>
